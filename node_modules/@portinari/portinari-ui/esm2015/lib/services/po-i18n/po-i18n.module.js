import * as tslib_1 from "tslib";
var PoI18nModule_1;
import { HttpClient, HttpClientModule } from '@angular/common/http';
import { APP_INITIALIZER, NgModule } from '@angular/core';
import { PoLanguageService } from './../po-language/po-language.service';
import { I18N_CONFIG } from './po-i18n-config-injection-token';
import { returnPoI18nService, PoI18nService } from './po-i18n.service';
import { PoLanguageModule } from '../po-language/po-language.module';
/**
 * @description
 *
 * Módulo do serviço `PoI18nService` para controle de idiomas com PO.
 *
 * Para utilização do serviço de idiomas `PoI18nService`, deve-se importar este módulo mesmo já havendo importado
 * o módulo `PoModule`. Na importação deve ser invocado o método `config`, informando um objeto que deve implementar
 * a interface [`PoI18nConfig`](documentation/po-i18n#poI18nConfig) para configuração.
 *
 * <a id="i18n-config"></a>
 * **Exemplo de configuração do módulo do i18n:**
 * ```
 * import { PoI18nConfig } from '@portinari/portinari-ui';
 *
 * import { generalEn } from './i18n/general-en';
 * import { generalPt } from './i18n/general-pt';
 *
 * const i18nConfig: PoI18nConfig = {
 *   default: {
 *     language: 'pt-BR',
 *     context: 'general',
 *     cache: true
 *   },
 *   contexts: {
 *     general: {
 *       'pt-BR': generalPt,
 *       'en-US': generalEn
 *     },
 *     hcm: {
 *       url: 'http://10.1.1.1/api/translations/hcm/'
 *     }
 *   }
 * };
 *
 * @NgModule({
 *   declarations: [],
 *   imports: [
 *     PoModule,
 *     PoI18nModule.config(i18nConfig)
 *   ],
 *   bootstrap: [AppComponent]
 * })
 * ```
 *
 * Para cada contexto é possível definir a origem das literais, que podem ser de um serviço REST ou
 * de um objeto. Exemplo:
 *
 * Arquivo general-pt.ts
 * ```
 * export const generalPt = {
 *  add: 'Adicionar',
 *  greeting: 'Prazer, {0} {1}',
 *  people: '{0} Pessoas,
 *  remove: 'Remover'
 * }
 * ```
 *
 * Arquivo general-en.ts
 * ```
 * export const generalEn = {
 *  add: 'Add',
 *  greeting: 'Nice to meet you, {0} {1}',
 *  people: '{0} People,
 *  remove: 'Remove'
 * }
 * ```
 *
 * **Exemplo de configuração de contextos usando constantes externas:**
 * ```
 * import { PoI18nConfig } from '@portinari/portinari-ui';
 *
 * import { generalEn } from './i18n/general-en';
 * import { generalPt } from './i18n/general-pt';
 *
 * const i18nConfig: PoI18nConfig = {
 *   contexts: {
 *     general: {
 *       'pt-BR': generalPt, // constantes em arquivos separados
 *       'en-US': generalEn // constantes em arquivos separados
 *     },
 *     crm: {
 *       url: 'http://10.0.0.1:3000/api/translations/crm'
 *     }
 *   },
 *   default: {}
 * }
 * ```
 *
 * **Exemplo de configuração de um contexto utilizando serviço:**
 *
 * Ao optar por utilizar um serviço para configuração de contexto, deverá ser definida a URL
 * específica do contexto, como nos exemplos abaixo:
 *
 *  - http://10.0.0.1:3000/api/translations/crm
 *  - http://10.0.0.1:3000/api/translations/general
 *
 * Os idiomas e literais serão automaticamente buscados com parâmetros na própria URL:
 * - **language**: o idioma será sempre passado por parâmetro e é recomendado utilizar uma das linguagens
 * suportadas pelo PO (`pt-br`, `en-us` ou `es-es`).
 * - **literals**: as literais serão separadas por vírgula. Caso esse parâmetro não seja informado, o
 * serviço deve retornar todas as literais do idioma.
 *
 * Exemplos de requisição:
 *
 *  - http://10.0.0.1:3000/api/translations/crm?language=pt-br
 *  - http://10.0.0.1:3000/api/translations/crm?language=pt-br&literals=add,remove,text
 *
 * > Sempre que o idioma solicitado não for encontrado, será buscado por `pt-br`.
 *
 * Além dos contextos, é possível definir as configurações *default* do sistema na configuração do
 * módulo utilizando a interface [`PoI18nConfig`](documentation/po-i18n#poI18nConfig):
 *
 * **Exemplo de padrões definidos:**
 * ```
 * const i18nConfig: PoI18nConfig = {
 *   contexts: {
 *     general: { }
 *   },
 *   default: {
 *    language: 'pt-BR',
 *    context: 'general',
 *    cache: true
 *   }
 * }
 * ```
 *
 * **Importante:**
 *
 * Recomenda-se que as definições *default* sejam realizadas apenas uma vez na aplicação,
 * preferencialmente no módulo `AppModule`.
 *
 * **i18n com *Lazy loading***
 *
 * Para aplicações que utilizem a abordagem de módulos com carregamento *lazy loading*, caso seja
 * definida outra configuração do `PoI18nModule`, deve-se atentar os seguintes detalhes:
 *
 * - Caso existam literais comuns na aplicação, estas devem ser reimportadas;
 * - Não defina outra *default language* para este módulo. Caso for definida, será sobreposta para
 * toda a aplicação;
 * - Caso precise de módulos carregados via *lazy loading* com linguagens diferentes, utilize o
 * método [`setLanguage()`](documentation/po-i18n#setLanguage) disponibilizado pelo `PoI18nService`
 * para definir a linguagem da aplicação e dos módulos com as linguagens diferentes.
 */
let PoI18nModule = PoI18nModule_1 = class PoI18nModule {
    static config(config) {
        return {
            ngModule: PoI18nModule_1,
            providers: [
                {
                    provide: I18N_CONFIG,
                    useValue: config
                },
                {
                    provide: APP_INITIALIZER,
                    useFactory: initializeLanguageDefault,
                    multi: true,
                    deps: [I18N_CONFIG, PoLanguageService]
                },
                {
                    provide: PoI18nService,
                    useFactory: returnPoI18nService,
                    deps: [I18N_CONFIG, HttpClient, PoLanguageService]
                }
            ]
        };
    }
};
PoI18nModule = PoI18nModule_1 = tslib_1.__decorate([
    NgModule({
        imports: [
            HttpClientModule,
            PoLanguageModule
        ]
    })
], PoI18nModule);
export { PoI18nModule };
export function initializeLanguageDefault(config, languageService) {
    // tslint:disable-next-line:prefer-immediate-return
    const setDefaultLanguage = () => {
        if (config.default.language) {
            languageService.setLanguageDefault(config.default.language);
        }
    };
    return setDefaultLanguage;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8taTE4bi5tb2R1bGUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AcG9ydGluYXJpL3BvcnRpbmFyaS11aS8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlcy9wby1pMThuL3BvLWkxOG4ubW9kdWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3BFLE9BQU8sRUFBRSxlQUFlLEVBQXVCLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUUvRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUV6RSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDL0QsT0FBTyxFQUFFLG1CQUFtQixFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBRXZFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBRXJFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBOElHO0FBUUgsSUFBYSxZQUFZLG9CQUF6QixNQUFhLFlBQVk7SUFFdkIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFvQjtRQUNoQyxPQUFPO1lBQ0wsUUFBUSxFQUFFLGNBQVk7WUFDdEIsU0FBUyxFQUFFO2dCQUNUO29CQUNFLE9BQU8sRUFBRSxXQUFXO29CQUNwQixRQUFRLEVBQUUsTUFBTTtpQkFDakI7Z0JBQ0Q7b0JBQ0UsT0FBTyxFQUFFLGVBQWU7b0JBQ3hCLFVBQVUsRUFBRSx5QkFBeUI7b0JBQ3JDLEtBQUssRUFBRSxJQUFJO29CQUNYLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRSxpQkFBaUIsQ0FBQztpQkFDdkM7Z0JBQ0Q7b0JBQ0UsT0FBTyxFQUFFLGFBQWE7b0JBQ3RCLFVBQVUsRUFBRSxtQkFBbUI7b0JBQy9CLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRSxVQUFVLEVBQUUsaUJBQWlCLENBQUM7aUJBQ25EO2FBQ0Y7U0FDRixDQUFDO0lBQ0osQ0FBQztDQUVGLENBQUE7QUF6QlksWUFBWTtJQU54QixRQUFRLENBQUM7UUFDUixPQUFPLEVBQUU7WUFDUCxnQkFBZ0I7WUFDaEIsZ0JBQWdCO1NBQ2pCO0tBQ0YsQ0FBQztHQUNXLFlBQVksQ0F5QnhCO1NBekJZLFlBQVk7QUEyQnpCLE1BQU0sVUFBVSx5QkFBeUIsQ0FBQyxNQUFvQixFQUFFLGVBQWtDO0lBQ2hHLG1EQUFtRDtJQUNuRCxNQUFNLGtCQUFrQixHQUFHLEdBQUcsRUFBRTtRQUM5QixJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFO1lBQzNCLGVBQWUsQ0FBQyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQzdEO0lBQ0gsQ0FBQyxDQUFDO0lBQ0YsT0FBTyxrQkFBa0IsQ0FBQztBQUM1QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSHR0cENsaWVudCwgSHR0cENsaWVudE1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IEFQUF9JTklUSUFMSVpFUiwgTW9kdWxlV2l0aFByb3ZpZGVycywgTmdNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgUG9MYW5ndWFnZVNlcnZpY2UgfSBmcm9tICcuLy4uL3BvLWxhbmd1YWdlL3BvLWxhbmd1YWdlLnNlcnZpY2UnO1xuXG5pbXBvcnQgeyBJMThOX0NPTkZJRyB9IGZyb20gJy4vcG8taTE4bi1jb25maWctaW5qZWN0aW9uLXRva2VuJztcbmltcG9ydCB7IHJldHVyblBvSTE4blNlcnZpY2UsIFBvSTE4blNlcnZpY2UgfSBmcm9tICcuL3BvLWkxOG4uc2VydmljZSc7XG5pbXBvcnQgeyBQb0kxOG5Db25maWcgfSBmcm9tICcuL2ludGVyZmFjZXMvcG8taTE4bi1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IFBvTGFuZ3VhZ2VNb2R1bGUgfSBmcm9tICcuLi9wby1sYW5ndWFnZS9wby1sYW5ndWFnZS5tb2R1bGUnO1xuXG4vKipcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIE3Ds2R1bG8gZG8gc2VydmnDp28gYFBvSTE4blNlcnZpY2VgIHBhcmEgY29udHJvbGUgZGUgaWRpb21hcyBjb20gUE8uXG4gKlxuICogUGFyYSB1dGlsaXphw6fDo28gZG8gc2VydmnDp28gZGUgaWRpb21hcyBgUG9JMThuU2VydmljZWAsIGRldmUtc2UgaW1wb3J0YXIgZXN0ZSBtw7NkdWxvIG1lc21vIGrDoSBoYXZlbmRvIGltcG9ydGFkb1xuICogbyBtw7NkdWxvIGBQb01vZHVsZWAuIE5hIGltcG9ydGHDp8OjbyBkZXZlIHNlciBpbnZvY2FkbyBvIG3DqXRvZG8gYGNvbmZpZ2AsIGluZm9ybWFuZG8gdW0gb2JqZXRvIHF1ZSBkZXZlIGltcGxlbWVudGFyXG4gKiBhIGludGVyZmFjZSBbYFBvSTE4bkNvbmZpZ2BdKGRvY3VtZW50YXRpb24vcG8taTE4biNwb0kxOG5Db25maWcpIHBhcmEgY29uZmlndXJhw6fDo28uXG4gKlxuICogPGEgaWQ9XCJpMThuLWNvbmZpZ1wiPjwvYT5cbiAqICoqRXhlbXBsbyBkZSBjb25maWd1cmHDp8OjbyBkbyBtw7NkdWxvIGRvIGkxOG46KipcbiAqIGBgYFxuICogaW1wb3J0IHsgUG9JMThuQ29uZmlnIH0gZnJvbSAnQHBvcnRpbmFyaS9wb3J0aW5hcmktdWknO1xuICpcbiAqIGltcG9ydCB7IGdlbmVyYWxFbiB9IGZyb20gJy4vaTE4bi9nZW5lcmFsLWVuJztcbiAqIGltcG9ydCB7IGdlbmVyYWxQdCB9IGZyb20gJy4vaTE4bi9nZW5lcmFsLXB0JztcbiAqXG4gKiBjb25zdCBpMThuQ29uZmlnOiBQb0kxOG5Db25maWcgPSB7XG4gKiAgIGRlZmF1bHQ6IHtcbiAqICAgICBsYW5ndWFnZTogJ3B0LUJSJyxcbiAqICAgICBjb250ZXh0OiAnZ2VuZXJhbCcsXG4gKiAgICAgY2FjaGU6IHRydWVcbiAqICAgfSxcbiAqICAgY29udGV4dHM6IHtcbiAqICAgICBnZW5lcmFsOiB7XG4gKiAgICAgICAncHQtQlInOiBnZW5lcmFsUHQsXG4gKiAgICAgICAnZW4tVVMnOiBnZW5lcmFsRW5cbiAqICAgICB9LFxuICogICAgIGhjbToge1xuICogICAgICAgdXJsOiAnaHR0cDovLzEwLjEuMS4xL2FwaS90cmFuc2xhdGlvbnMvaGNtLydcbiAqICAgICB9XG4gKiAgIH1cbiAqIH07XG4gKlxuICogQE5nTW9kdWxlKHtcbiAqICAgZGVjbGFyYXRpb25zOiBbXSxcbiAqICAgaW1wb3J0czogW1xuICogICAgIFBvTW9kdWxlLFxuICogICAgIFBvSTE4bk1vZHVsZS5jb25maWcoaTE4bkNvbmZpZylcbiAqICAgXSxcbiAqICAgYm9vdHN0cmFwOiBbQXBwQ29tcG9uZW50XVxuICogfSlcbiAqIGBgYFxuICpcbiAqIFBhcmEgY2FkYSBjb250ZXh0byDDqSBwb3Nzw612ZWwgZGVmaW5pciBhIG9yaWdlbSBkYXMgbGl0ZXJhaXMsIHF1ZSBwb2RlbSBzZXIgZGUgdW0gc2VydmnDp28gUkVTVCBvdVxuICogZGUgdW0gb2JqZXRvLiBFeGVtcGxvOlxuICpcbiAqIEFycXVpdm8gZ2VuZXJhbC1wdC50c1xuICogYGBgXG4gKiBleHBvcnQgY29uc3QgZ2VuZXJhbFB0ID0ge1xuICogIGFkZDogJ0FkaWNpb25hcicsXG4gKiAgZ3JlZXRpbmc6ICdQcmF6ZXIsIHswfSB7MX0nLFxuICogIHBlb3BsZTogJ3swfSBQZXNzb2FzLFxuICogIHJlbW92ZTogJ1JlbW92ZXInXG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBBcnF1aXZvIGdlbmVyYWwtZW4udHNcbiAqIGBgYFxuICogZXhwb3J0IGNvbnN0IGdlbmVyYWxFbiA9IHtcbiAqICBhZGQ6ICdBZGQnLFxuICogIGdyZWV0aW5nOiAnTmljZSB0byBtZWV0IHlvdSwgezB9IHsxfScsXG4gKiAgcGVvcGxlOiAnezB9IFBlb3BsZSxcbiAqICByZW1vdmU6ICdSZW1vdmUnXG4gKiB9XG4gKiBgYGBcbiAqXG4gKiAqKkV4ZW1wbG8gZGUgY29uZmlndXJhw6fDo28gZGUgY29udGV4dG9zIHVzYW5kbyBjb25zdGFudGVzIGV4dGVybmFzOioqXG4gKiBgYGBcbiAqIGltcG9ydCB7IFBvSTE4bkNvbmZpZyB9IGZyb20gJ0Bwb3J0aW5hcmkvcG9ydGluYXJpLXVpJztcbiAqXG4gKiBpbXBvcnQgeyBnZW5lcmFsRW4gfSBmcm9tICcuL2kxOG4vZ2VuZXJhbC1lbic7XG4gKiBpbXBvcnQgeyBnZW5lcmFsUHQgfSBmcm9tICcuL2kxOG4vZ2VuZXJhbC1wdCc7XG4gKlxuICogY29uc3QgaTE4bkNvbmZpZzogUG9JMThuQ29uZmlnID0ge1xuICogICBjb250ZXh0czoge1xuICogICAgIGdlbmVyYWw6IHtcbiAqICAgICAgICdwdC1CUic6IGdlbmVyYWxQdCwgLy8gY29uc3RhbnRlcyBlbSBhcnF1aXZvcyBzZXBhcmFkb3NcbiAqICAgICAgICdlbi1VUyc6IGdlbmVyYWxFbiAvLyBjb25zdGFudGVzIGVtIGFycXVpdm9zIHNlcGFyYWRvc1xuICogICAgIH0sXG4gKiAgICAgY3JtOiB7XG4gKiAgICAgICB1cmw6ICdodHRwOi8vMTAuMC4wLjE6MzAwMC9hcGkvdHJhbnNsYXRpb25zL2NybSdcbiAqICAgICB9XG4gKiAgIH0sXG4gKiAgIGRlZmF1bHQ6IHt9XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiAqKkV4ZW1wbG8gZGUgY29uZmlndXJhw6fDo28gZGUgdW0gY29udGV4dG8gdXRpbGl6YW5kbyBzZXJ2acOnbzoqKlxuICpcbiAqIEFvIG9wdGFyIHBvciB1dGlsaXphciB1bSBzZXJ2acOnbyBwYXJhIGNvbmZpZ3VyYcOnw6NvIGRlIGNvbnRleHRvLCBkZXZlcsOhIHNlciBkZWZpbmlkYSBhIFVSTFxuICogZXNwZWPDrWZpY2EgZG8gY29udGV4dG8sIGNvbW8gbm9zIGV4ZW1wbG9zIGFiYWl4bzpcbiAqXG4gKiAgLSBodHRwOi8vMTAuMC4wLjE6MzAwMC9hcGkvdHJhbnNsYXRpb25zL2NybVxuICogIC0gaHR0cDovLzEwLjAuMC4xOjMwMDAvYXBpL3RyYW5zbGF0aW9ucy9nZW5lcmFsXG4gKlxuICogT3MgaWRpb21hcyBlIGxpdGVyYWlzIHNlcsOjbyBhdXRvbWF0aWNhbWVudGUgYnVzY2Fkb3MgY29tIHBhcsOibWV0cm9zIG5hIHByw7NwcmlhIFVSTDpcbiAqIC0gKipsYW5ndWFnZSoqOiBvIGlkaW9tYSBzZXLDoSBzZW1wcmUgcGFzc2FkbyBwb3IgcGFyw6JtZXRybyBlIMOpIHJlY29tZW5kYWRvIHV0aWxpemFyIHVtYSBkYXMgbGluZ3VhZ2Vuc1xuICogc3Vwb3J0YWRhcyBwZWxvIFBPIChgcHQtYnJgLCBgZW4tdXNgIG91IGBlcy1lc2ApLlxuICogLSAqKmxpdGVyYWxzKio6IGFzIGxpdGVyYWlzIHNlcsOjbyBzZXBhcmFkYXMgcG9yIHbDrXJndWxhLiBDYXNvIGVzc2UgcGFyw6JtZXRybyBuw6NvIHNlamEgaW5mb3JtYWRvLCBvXG4gKiBzZXJ2acOnbyBkZXZlIHJldG9ybmFyIHRvZGFzIGFzIGxpdGVyYWlzIGRvIGlkaW9tYS5cbiAqXG4gKiBFeGVtcGxvcyBkZSByZXF1aXNpw6fDo286XG4gKlxuICogIC0gaHR0cDovLzEwLjAuMC4xOjMwMDAvYXBpL3RyYW5zbGF0aW9ucy9jcm0/bGFuZ3VhZ2U9cHQtYnJcbiAqICAtIGh0dHA6Ly8xMC4wLjAuMTozMDAwL2FwaS90cmFuc2xhdGlvbnMvY3JtP2xhbmd1YWdlPXB0LWJyJmxpdGVyYWxzPWFkZCxyZW1vdmUsdGV4dFxuICpcbiAqID4gU2VtcHJlIHF1ZSBvIGlkaW9tYSBzb2xpY2l0YWRvIG7Do28gZm9yIGVuY29udHJhZG8sIHNlcsOhIGJ1c2NhZG8gcG9yIGBwdC1icmAuXG4gKlxuICogQWzDqW0gZG9zIGNvbnRleHRvcywgw6kgcG9zc8OtdmVsIGRlZmluaXIgYXMgY29uZmlndXJhw6fDtWVzICpkZWZhdWx0KiBkbyBzaXN0ZW1hIG5hIGNvbmZpZ3VyYcOnw6NvIGRvXG4gKiBtw7NkdWxvIHV0aWxpemFuZG8gYSBpbnRlcmZhY2UgW2BQb0kxOG5Db25maWdgXShkb2N1bWVudGF0aW9uL3BvLWkxOG4jcG9JMThuQ29uZmlnKTpcbiAqXG4gKiAqKkV4ZW1wbG8gZGUgcGFkcsO1ZXMgZGVmaW5pZG9zOioqXG4gKiBgYGBcbiAqIGNvbnN0IGkxOG5Db25maWc6IFBvSTE4bkNvbmZpZyA9IHtcbiAqICAgY29udGV4dHM6IHtcbiAqICAgICBnZW5lcmFsOiB7IH1cbiAqICAgfSxcbiAqICAgZGVmYXVsdDoge1xuICogICAgbGFuZ3VhZ2U6ICdwdC1CUicsXG4gKiAgICBjb250ZXh0OiAnZ2VuZXJhbCcsXG4gKiAgICBjYWNoZTogdHJ1ZVxuICogICB9XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiAqKkltcG9ydGFudGU6KipcbiAqXG4gKiBSZWNvbWVuZGEtc2UgcXVlIGFzIGRlZmluacOnw7VlcyAqZGVmYXVsdCogc2VqYW0gcmVhbGl6YWRhcyBhcGVuYXMgdW1hIHZleiBuYSBhcGxpY2HDp8OjbyxcbiAqIHByZWZlcmVuY2lhbG1lbnRlIG5vIG3Ds2R1bG8gYEFwcE1vZHVsZWAuXG4gKlxuICogKippMThuIGNvbSAqTGF6eSBsb2FkaW5nKioqXG4gKlxuICogUGFyYSBhcGxpY2HDp8O1ZXMgcXVlIHV0aWxpemVtIGEgYWJvcmRhZ2VtIGRlIG3Ds2R1bG9zIGNvbSBjYXJyZWdhbWVudG8gKmxhenkgbG9hZGluZyosIGNhc28gc2VqYVxuICogZGVmaW5pZGEgb3V0cmEgY29uZmlndXJhw6fDo28gZG8gYFBvSTE4bk1vZHVsZWAsIGRldmUtc2UgYXRlbnRhciBvcyBzZWd1aW50ZXMgZGV0YWxoZXM6XG4gKlxuICogLSBDYXNvIGV4aXN0YW0gbGl0ZXJhaXMgY29tdW5zIG5hIGFwbGljYcOnw6NvLCBlc3RhcyBkZXZlbSBzZXIgcmVpbXBvcnRhZGFzO1xuICogLSBOw6NvIGRlZmluYSBvdXRyYSAqZGVmYXVsdCBsYW5ndWFnZSogcGFyYSBlc3RlIG3Ds2R1bG8uIENhc28gZm9yIGRlZmluaWRhLCBzZXLDoSBzb2JyZXBvc3RhIHBhcmFcbiAqIHRvZGEgYSBhcGxpY2HDp8OjbztcbiAqIC0gQ2FzbyBwcmVjaXNlIGRlIG3Ds2R1bG9zIGNhcnJlZ2Fkb3MgdmlhICpsYXp5IGxvYWRpbmcqIGNvbSBsaW5ndWFnZW5zIGRpZmVyZW50ZXMsIHV0aWxpemUgb1xuICogbcOpdG9kbyBbYHNldExhbmd1YWdlKClgXShkb2N1bWVudGF0aW9uL3BvLWkxOG4jc2V0TGFuZ3VhZ2UpIGRpc3BvbmliaWxpemFkbyBwZWxvIGBQb0kxOG5TZXJ2aWNlYFxuICogcGFyYSBkZWZpbmlyIGEgbGluZ3VhZ2VtIGRhIGFwbGljYcOnw6NvIGUgZG9zIG3Ds2R1bG9zIGNvbSBhcyBsaW5ndWFnZW5zIGRpZmVyZW50ZXMuXG4gKi9cblxuQE5nTW9kdWxlKHtcbiAgaW1wb3J0czogW1xuICAgIEh0dHBDbGllbnRNb2R1bGUsXG4gICAgUG9MYW5ndWFnZU1vZHVsZVxuICBdXG59KVxuZXhwb3J0IGNsYXNzIFBvSTE4bk1vZHVsZSB7XG5cbiAgc3RhdGljIGNvbmZpZyhjb25maWc6IFBvSTE4bkNvbmZpZyk6IE1vZHVsZVdpdGhQcm92aWRlcnMge1xuICAgIHJldHVybiB7XG4gICAgICBuZ01vZHVsZTogUG9JMThuTW9kdWxlLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBJMThOX0NPTkZJRyxcbiAgICAgICAgICB1c2VWYWx1ZTogY29uZmlnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBBUFBfSU5JVElBTElaRVIsXG4gICAgICAgICAgdXNlRmFjdG9yeTogaW5pdGlhbGl6ZUxhbmd1YWdlRGVmYXVsdCxcbiAgICAgICAgICBtdWx0aTogdHJ1ZSxcbiAgICAgICAgICBkZXBzOiBbSTE4Tl9DT05GSUcsIFBvTGFuZ3VhZ2VTZXJ2aWNlXVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogUG9JMThuU2VydmljZSxcbiAgICAgICAgICB1c2VGYWN0b3J5OiByZXR1cm5Qb0kxOG5TZXJ2aWNlLFxuICAgICAgICAgIGRlcHM6IFtJMThOX0NPTkZJRywgSHR0cENsaWVudCwgUG9MYW5ndWFnZVNlcnZpY2VdXG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9O1xuICB9XG5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVMYW5ndWFnZURlZmF1bHQoY29uZmlnOiBQb0kxOG5Db25maWcsIGxhbmd1YWdlU2VydmljZTogUG9MYW5ndWFnZVNlcnZpY2UpIHtcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1pbW1lZGlhdGUtcmV0dXJuXG4gIGNvbnN0IHNldERlZmF1bHRMYW5ndWFnZSA9ICgpID0+IHtcbiAgICBpZiAoY29uZmlnLmRlZmF1bHQubGFuZ3VhZ2UpIHtcbiAgICAgIGxhbmd1YWdlU2VydmljZS5zZXRMYW5ndWFnZURlZmF1bHQoY29uZmlnLmRlZmF1bHQubGFuZ3VhZ2UpO1xuICAgIH1cbiAgfTtcbiAgcmV0dXJuIHNldERlZmF1bHRMYW5ndWFnZTtcbn1cbiJdfQ==