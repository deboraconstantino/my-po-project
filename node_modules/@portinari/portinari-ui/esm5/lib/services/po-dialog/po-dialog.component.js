import * as tslib_1 from "tslib";
import { Component, ViewChild } from '@angular/core';
import { browserLanguage, poLocaleDefault } from '../../utils/util';
import { PoDialogType } from './po-dialog.enum';
import { PoModalComponent } from '../../components/po-modal/po-modal.component';
export var poDialogAlertLiteralsDefault = {
    en: { ok: 'Ok' },
    es: { ok: 'Ok' },
    pt: { ok: 'Ok' },
    ru: { ok: 'Ок' }
};
export var poDialogConfirmLiteralsDefault = {
    en: { cancel: 'Cancel', confirm: 'Confirm' },
    es: { cancel: 'Cancelar', confirm: 'Confirmar' },
    pt: { cancel: 'Cancelar', confirm: 'Confirmar' },
    ru: { cancel: 'отменить', confirm: 'подтвердить' }
};
/**
 * @docsPrivate
 *
 * @description
 *
 * Componente que serve como container do po-dialog.service
 */
var PoDialogComponent = /** @class */ (function () {
    function PoDialogComponent() {
        // Objeto primary do poModal
        this.primaryAction = { label: 'ok', action: function () { } };
    }
    PoDialogComponent.prototype.ngOnDestroy = function () {
        this.closeSubscription.unsubscribe();
    };
    PoDialogComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.closeSubscription = this.poModal.onXClosed.subscribe(function (close) { return _this.destroy(); });
    };
    // Fecha o poModal
    PoDialogComponent.prototype.close = function () {
        this.poModal.close();
        this.destroy();
    };
    PoDialogComponent.prototype.destroy = function () {
        if (this.componentRef) {
            this.componentRef.destroy();
        }
    };
    // Insere os valores recebidos de this.open para o poModal
    PoDialogComponent.prototype.configDialog = function (primaryLabel, primaryAction, secondaryLabel, secondaryAction) {
        var _this = this;
        this.primaryAction = {
            label: primaryLabel,
            action: function () {
                if (primaryAction) {
                    primaryAction();
                }
                _this.close();
            }
        };
        if (secondaryLabel) {
            this.secondaryAction = {
                label: secondaryLabel,
                action: function () {
                    if (secondaryAction) {
                        secondaryAction();
                    }
                    _this.close();
                }
            };
        }
    };
    // Insere os valores recebidos de po-dialog.service de acordo com o tipo de diálago solicitado
    PoDialogComponent.prototype.open = function (dialogOptions, dialogType, componentRef) {
        this.title = dialogOptions.title;
        this.message = dialogOptions.message;
        this.componentRef = componentRef;
        this.setDialogLiterals(dialogOptions, dialogType);
        switch (dialogType) {
            case PoDialogType.Confirm: {
                this.configDialog(this.literalsConfirm.confirm, dialogOptions.confirm, this.literalsConfirm.cancel, dialogOptions.cancel);
                break;
            }
            case PoDialogType.Alert: {
                this.configDialog(this.literalsAlert.ok, dialogOptions.ok);
                break;
            }
        }
        this.poModal.open();
    };
    PoDialogComponent.prototype.setDialogLiterals = function (dialogOptions, dialogType) {
        var alertLiterals = poDialogAlertLiteralsDefault;
        var confirmLiterals = poDialogConfirmLiteralsDefault;
        var literals = dialogOptions.literals;
        if (dialogType === PoDialogType.Alert) {
            this.literalsAlert = tslib_1.__assign({}, alertLiterals[poLocaleDefault], alertLiterals[browserLanguage()], literals);
        }
        else {
            this.literalsConfirm = tslib_1.__assign({}, confirmLiterals[poLocaleDefault], confirmLiterals[browserLanguage()], literals);
        }
    };
    tslib_1.__decorate([
        ViewChild(PoModalComponent, { static: true }),
        tslib_1.__metadata("design:type", PoModalComponent)
    ], PoDialogComponent.prototype, "poModal", void 0);
    PoDialogComponent = tslib_1.__decorate([
        Component({
            template: "<po-modal\n  [p-title]=\"title\"\n  [p-primary-action]=\"primaryAction\"\n  [p-secondary-action]=\"secondaryAction\">\n  {{ message }}\n</po-modal>\n"
        })
    ], PoDialogComponent);
    return PoDialogComponent;
}());
export { PoDialogComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tZGlhbG9nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bwb3J0aW5hcmkvcG9ydGluYXJpLXVpLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL3BvLWRpYWxvZy9wby1kaWFsb2cuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFtQyxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFJdEYsT0FBTyxFQUFFLGVBQWUsRUFBRSxlQUFlLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUtwRSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFaEQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sOENBQThDLENBQUM7QUFFaEYsTUFBTSxDQUFDLElBQU0sNEJBQTRCLEdBQUc7SUFDMUMsRUFBRSxFQUEwQixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUU7SUFDeEMsRUFBRSxFQUEwQixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUU7SUFDeEMsRUFBRSxFQUEwQixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUU7SUFDeEMsRUFBRSxFQUEwQixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUU7Q0FDekMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxJQUFNLDhCQUE4QixHQUFHO0lBQzVDLEVBQUUsRUFBNEIsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUU7SUFDdEUsRUFBRSxFQUE0QixFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLFdBQVcsRUFBRTtJQUMxRSxFQUFFLEVBQTRCLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsV0FBVyxFQUFFO0lBQzFFLEVBQUUsRUFBNEIsRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRSxhQUFhLEVBQUU7Q0FDN0UsQ0FBQztBQUVGOzs7Ozs7R0FNRztBQUtIO0lBSEE7UUFhRSw0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QUFLLFlBQVksQ0FBQyxLQUFLLEVBQUU7WUFDckMsSUFBSSxDQUFDLGFBQWEsd0JBQU8sYUFBYSxDQUFDLGVBQWUsQ0FBQyxFQUFLLGFBQWEsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxFQUFLLFFBQVEsQ0FBQyxDQUFDO1NBQzVHO2FBQU07WUFDTCxJQUFJLENBQUMsZUFBZSx3QkFBTyxlQUFlLENBQUMsZUFBZSxDQUFDLEVBQUssZUFBZSxDQUFDLGVBQWUsRUFBRSxDQUFDLEVBQUssUUFBUSxDQUFDLENBQUM7U0FDbEg7SUFDSCxDQUFDO0lBNUc4QztRQUE5QyxTQUFTLENBQUMsZ0JBQWdCLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLENBQUM7MENBQVUsZ0JBQWdCO3NEQUFDO0lBRjlELGlCQUFpQjtRQUg3QixTQUFTLENBQUM7WUFDVCxpS0FBeUM7U0FDMUMsQ0FBQztPQUNXLGlCQUFpQixDQStHN0I7SUFBRCx3QkFBQztDQUFBLEFBL0dELElBK0dDO1NBL0dZLGlCQUFpQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgQ29tcG9uZW50UmVmLCBPbkRlc3Ryb3ksIE9uSW5pdCwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQgeyBicm93c2VyTGFuZ3VhZ2UsIHBvTG9jYWxlRGVmYXVsdCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWwnO1xuXG5pbXBvcnQgeyBQb0RpYWxvZ0FsZXJ0TGl0ZXJhbHMgfSBmcm9tICcuL2ludGVyZmFjZXMvcG8tZGlhbG9nLWFsZXJ0LWxpdGVyYWxzLmludGVyZmFjZSc7XG5pbXBvcnQgeyBQb0RpYWxvZ0FsZXJ0T3B0aW9ucywgUG9EaWFsb2dDb25maXJtT3B0aW9ucyB9IGZyb20gJy4vaW50ZXJmYWNlcy9wby1kaWFsb2cuaW50ZXJmYWNlJztcbmltcG9ydCB7IFBvRGlhbG9nQ29uZmlybUxpdGVyYWxzIH0gZnJvbSAnLi9pbnRlcmZhY2VzL3BvLWRpYWxvZy1jb25maXJtLWxpdGVyYWxzLmludGVyZmFjZSc7XG5pbXBvcnQgeyBQb0RpYWxvZ1R5cGUgfSBmcm9tICcuL3BvLWRpYWxvZy5lbnVtJztcbmltcG9ydCB7IFBvTW9kYWxBY3Rpb24gfSBmcm9tICcuLi8uLi9jb21wb25lbnRzL3BvLW1vZGFsL3BvLW1vZGFsLWFjdGlvbi5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgUG9Nb2RhbENvbXBvbmVudCB9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvcG8tbW9kYWwvcG8tbW9kYWwuY29tcG9uZW50JztcblxuZXhwb3J0IGNvbnN0IHBvRGlhbG9nQWxlcnRMaXRlcmFsc0RlZmF1bHQgPSB7XG4gIGVuOiA8UG9EaWFsb2dBbGVydExpdGVyYWxzPiB7IG9rOiAnT2snIH0sXG4gIGVzOiA8UG9EaWFsb2dBbGVydExpdGVyYWxzPiB7IG9rOiAnT2snIH0sXG4gIHB0OiA8UG9EaWFsb2dBbGVydExpdGVyYWxzPiB7IG9rOiAnT2snIH0sXG4gIHJ1OiA8UG9EaWFsb2dBbGVydExpdGVyYWxzPiB7IG9rOiAn0J7QuicgfVxufTtcblxuZXhwb3J0IGNvbnN0IHBvRGlhbG9nQ29uZmlybUxpdGVyYWxzRGVmYXVsdCA9IHtcbiAgZW46IDxQb0RpYWxvZ0NvbmZpcm1MaXRlcmFscz4geyBjYW5jZWw6ICdDYW5jZWwnLCBjb25maXJtOiAnQ29uZmlybScgfSxcbiAgZXM6IDxQb0RpYWxvZ0NvbmZpcm1MaXRlcmFscz4geyBjYW5jZWw6ICdDYW5jZWxhcicsIGNvbmZpcm06ICdDb25maXJtYXInIH0sXG4gIHB0OiA8UG9EaWFsb2dDb25maXJtTGl0ZXJhbHM+IHsgY2FuY2VsOiAnQ2FuY2VsYXInLCBjb25maXJtOiAnQ29uZmlybWFyJyB9LFxuICBydTogPFBvRGlhbG9nQ29uZmlybUxpdGVyYWxzPiB7IGNhbmNlbDogJ9C+0YLQvNC10L3QuNGC0YwnLCBjb25maXJtOiAn0L/QvtC00YLQstC10YDQtNC40YLRjCcgfVxufTtcblxuLyoqXG4gKiBAZG9jc1ByaXZhdGVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBDb21wb25lbnRlIHF1ZSBzZXJ2ZSBjb21vIGNvbnRhaW5lciBkbyBwby1kaWFsb2cuc2VydmljZVxuICovXG5cbkBDb21wb25lbnQoe1xuICB0ZW1wbGF0ZVVybDogJy4vcG8tZGlhbG9nLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBQb0RpYWxvZ0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uRGVzdHJveSwgT25Jbml0IHtcbiAgLy8gVmlld0NoaWxkIHBhcmEgbyB1c28gZG8gcG8tbW9kYWwuY29tcG9uZW50XG4gIEBWaWV3Q2hpbGQoUG9Nb2RhbENvbXBvbmVudCwgeyBzdGF0aWM6IHRydWUgfSkgcG9Nb2RhbDogUG9Nb2RhbENvbXBvbmVudDtcblxuICAvLyBUaXRsZSBkbyBwb01vZGFsXG4gIHRpdGxlOiBzdHJpbmc7XG5cbiAgLy8gTWVzc2FnZSBkbyBwb01vZGFsXG4gIG1lc3NhZ2U6IHN0cmluZztcblxuICAvLyBPYmpldG8gcHJpbWFyeSBkbyBwb01vZGFsXG4gIHByaW1hcnlBY3Rpb246IFBvTW9kYWxBY3Rpb24gPSB7IGxhYmVsOiAnb2snLCBhY3Rpb246ICgpID0+IHsgfSB9O1xuXG4gIC8vIE9iamV0byBzZWNvbmRhcnkgZG8gcG9Nb2RhbFxuICBzZWNvbmRhcnlBY3Rpb246IFBvTW9kYWxBY3Rpb247XG5cbiAgLy8gTGl0ZXJhaXMgdXNhZGFzIG5vcyBib3TDo28gZGUgYWxlcnRhIGRvIHBvTW9kYWxcbiAgbGl0ZXJhbHNBbGVydDogUG9EaWFsb2dBbGVydExpdGVyYWxzO1xuXG4gIC8vIExpdGVyYWlzIHVzYWRhcyBub3MgYm90w7VlcyBkZSBjb25maXJtYcOnw6NvIGRvIHBvTW9kYWxcbiAgbGl0ZXJhbHNDb25maXJtOiBQb0RpYWxvZ0NvbmZpcm1MaXRlcmFscztcblxuICAvLyBBdHJpYnV0byBwYXJhIGFybWF6ZW5hciBhIHJlZmVyZW5jaWEgZG8gY29tcG9uZW50ZSBjcmlhZG8gdmlhIHNlcnZpw6dvLlxuICBwcml2YXRlIGNvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPFBvRGlhbG9nQ29tcG9uZW50PjtcbiAgcHJpdmF0ZSBjbG9zZVN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMuY2xvc2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMuY2xvc2VTdWJzY3JpcHRpb24gPSB0aGlzLnBvTW9kYWwub25YQ2xvc2VkLnN1YnNjcmliZShjbG9zZSA9PiB0aGlzLmRlc3Ryb3koKSk7XG4gIH1cblxuICAgIC8vIEZlY2hhIG8gcG9Nb2RhbFxuICBjbG9zZSgpOiB2b2lkIHtcbiAgICB0aGlzLnBvTW9kYWwuY2xvc2UoKTtcbiAgICB0aGlzLmRlc3Ryb3koKTtcbiAgfVxuXG4gIGRlc3Ryb3koKSB7XG4gICAgaWYgKHRoaXMuY29tcG9uZW50UmVmKSB7XG4gICAgICB0aGlzLmNvbXBvbmVudFJlZi5kZXN0cm95KCk7XG4gICAgfVxuICB9XG5cbiAgLy8gSW5zZXJlIG9zIHZhbG9yZXMgcmVjZWJpZG9zIGRlIHRoaXMub3BlbiBwYXJhIG8gcG9Nb2RhbFxuICBjb25maWdEaWFsb2cocHJpbWFyeUxhYmVsPywgcHJpbWFyeUFjdGlvbj8sIHNlY29uZGFyeUxhYmVsPywgc2Vjb25kYXJ5QWN0aW9uPykge1xuXG4gICAgdGhpcy5wcmltYXJ5QWN0aW9uID0ge1xuICAgICAgbGFiZWw6IHByaW1hcnlMYWJlbCxcbiAgICAgIGFjdGlvbjogKCkgPT4ge1xuICAgICAgICAgIGlmIChwcmltYXJ5QWN0aW9uKSB7XG4gICAgICAgICAgICBwcmltYXJ5QWN0aW9uKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaWYgKHNlY29uZGFyeUxhYmVsKSB7XG4gICAgICB0aGlzLnNlY29uZGFyeUFjdGlvbiA9IHtcbiAgICAgICAgbGFiZWw6IHNlY29uZGFyeUxhYmVsLFxuICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICBpZiAoc2Vjb25kYXJ5QWN0aW9uKSB7XG4gICAgICAgICAgICBzZWNvbmRhcnlBY3Rpb24oKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8vIEluc2VyZSBvcyB2YWxvcmVzIHJlY2ViaWRvcyBkZSBwby1kaWFsb2cuc2VydmljZSBkZSBhY29yZG8gY29tIG8gdGlwbyBkZSBkacOhbGFnbyBzb2xpY2l0YWRvXG4gIG9wZW4oZGlhbG9nT3B0aW9uczogKFBvRGlhbG9nQ29uZmlybU9wdGlvbnMgfCBQb0RpYWxvZ0FsZXJ0T3B0aW9ucyksXG4gICAgICAgZGlhbG9nVHlwZTogUG9EaWFsb2dUeXBlLFxuICAgICAgIGNvbXBvbmVudFJlZj86IENvbXBvbmVudFJlZjxQb0RpYWxvZ0NvbXBvbmVudD4pOiB2b2lkIHtcblxuICAgIHRoaXMudGl0bGUgPSBkaWFsb2dPcHRpb25zLnRpdGxlO1xuICAgIHRoaXMubWVzc2FnZSA9IGRpYWxvZ09wdGlvbnMubWVzc2FnZTtcblxuICAgIHRoaXMuY29tcG9uZW50UmVmID0gY29tcG9uZW50UmVmO1xuXG4gICAgdGhpcy5zZXREaWFsb2dMaXRlcmFscyhkaWFsb2dPcHRpb25zLCBkaWFsb2dUeXBlKTtcblxuICAgIHN3aXRjaCAoZGlhbG9nVHlwZSkge1xuICAgICAgY2FzZSBQb0RpYWxvZ1R5cGUuQ29uZmlybToge1xuICAgICAgICB0aGlzLmNvbmZpZ0RpYWxvZyhcbiAgICAgICAgICB0aGlzLmxpdGVyYWxzQ29uZmlybS5jb25maXJtLCAoPFBvRGlhbG9nQ29uZmlybU9wdGlvbnM+ZGlhbG9nT3B0aW9ucykuY29uZmlybSxcbiAgICAgICAgICB0aGlzLmxpdGVyYWxzQ29uZmlybS5jYW5jZWwsICg8UG9EaWFsb2dDb25maXJtT3B0aW9ucz5kaWFsb2dPcHRpb25zKS5jYW5jZWwpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgUG9EaWFsb2dUeXBlLkFsZXJ0OiB7XG4gICAgICAgIHRoaXMuY29uZmlnRGlhbG9nKHRoaXMubGl0ZXJhbHNBbGVydC5vaywgKDxQb0RpYWxvZ0FsZXJ0T3B0aW9ucz5kaWFsb2dPcHRpb25zKS5vayk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMucG9Nb2RhbC5vcGVuKCk7XG4gIH1cblxuICBwcml2YXRlIHNldERpYWxvZ0xpdGVyYWxzKGRpYWxvZ09wdGlvbnM6IFBvRGlhbG9nQ29uZmlybU9wdGlvbnMgfCBQb0RpYWxvZ0FsZXJ0T3B0aW9ucywgZGlhbG9nVHlwZTogUG9EaWFsb2dUeXBlKSB7XG4gICAgY29uc3QgYWxlcnRMaXRlcmFscyA9IHBvRGlhbG9nQWxlcnRMaXRlcmFsc0RlZmF1bHQ7XG4gICAgY29uc3QgY29uZmlybUxpdGVyYWxzID0gcG9EaWFsb2dDb25maXJtTGl0ZXJhbHNEZWZhdWx0O1xuICAgIGNvbnN0IGxpdGVyYWxzID0gZGlhbG9nT3B0aW9ucy5saXRlcmFscztcblxuICAgIGlmIChkaWFsb2dUeXBlID09PSBQb0RpYWxvZ1R5cGUuQWxlcnQpIHtcbiAgICAgIHRoaXMubGl0ZXJhbHNBbGVydCA9IHsuLi5hbGVydExpdGVyYWxzW3BvTG9jYWxlRGVmYXVsdF0sIC4uLmFsZXJ0TGl0ZXJhbHNbYnJvd3Nlckxhbmd1YWdlKCldLCAuLi5saXRlcmFsc307XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubGl0ZXJhbHNDb25maXJtID0gey4uLmNvbmZpcm1MaXRlcmFsc1twb0xvY2FsZURlZmF1bHRdLCAuLi5jb25maXJtTGl0ZXJhbHNbYnJvd3Nlckxhbmd1YWdlKCldLCAuLi5saXRlcmFsc307XG4gICAgfVxuICB9XG59XG4iXX0=