/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, ViewContainerRef } from '@angular/core';
import { NgForm } from '@angular/forms';
import { ActivatedRoute, Router } from '@angular/router';
import { PoComponentInjectorService, PoModalComponent } from '@portinari/portinari-ui';
import { browserLanguage, isExternalLink, isTypeof, poLocaleDefault } from '../../utils/util';
import { PoModalPasswordRecoveryComponent } from '../po-modal-password-recovery/po-modal-password-recovery.component';
import { PoModalPasswordRecoveryType } from '../po-modal-password-recovery/enums/po-modal-password-recovery-type.enum';
import { PoPageChangePasswordBaseComponent } from './po-page-change-password-base.component';
import { poPageChangePasswordLiterals } from './literals/i18n/po-page-change-password-literals';
import { PoPageChangePasswordService } from './po-page-change-password.service';
/**
 * \@docsExtends PoPageChangePasswordBaseComponent
 *
 * \@example
 *
 * <example name="po-page-change-password-basic" title="Portinari Page Change Password Basic">
 *  <file name="sample-po-page-change-password-basic/sample-po-page-change-password-basic.component.html"> </file>
 *  <file name="sample-po-page-change-password-basic/sample-po-page-change-password-basic.component.ts"> </file>
 * </example>
 *
 * <example name="po-page-change-password-labs" title="Portinari Page Change Password Labs">
 *  <file name="sample-po-page-change-password-labs/sample-po-page-change-password-labs.component.html"> </file>
 *  <file name="sample-po-page-change-password-labs/sample-po-page-change-password-labs.component.ts"> </file>
 * </example>
 *
 * <example name="po-page-change-password-modify" title="Portinari Page Change Password Modify">
 *  <file name="sample-po-page-change-password-modify/sample-po-page-change-password-modify.component.html"> </file>
 *  <file name="sample-po-page-change-password-modify/sample-po-page-change-password-modify.component.ts"> </file>
 * </example>
 *
 * <example name="po-page-change-password-create" title="Portinari Page Change Password Create">
 *  <file name="sample-po-page-change-password-create/sample-po-page-change-password-create.component.html"> </file>
 *  <file name="sample-po-page-change-password-create/sample-po-page-change-password-create.component.ts"> </file>
 * </example>
 *
 * <example name="po-page-change-password-request" title="Portinari Page Change Password Request">
 *  <file name="sample-po-page-change-password-request/sample-po-page-change-password-request.component.html"> </file>
 *  <file name="sample-po-page-change-password-request/sample-po-page-change-password-request.component.ts"> </file>
 * </example>
 */
export class PoPageChangePasswordComponent extends PoPageChangePasswordBaseComponent {
    /**
     * @param {?} activatedRoute
     * @param {?} route
     * @param {?} router
     * @param {?} service
     * @param {?} poComponentInjector
     * @param {?} viewRef
     */
    constructor(activatedRoute, route, router, service, poComponentInjector, viewRef) {
        super();
        this.activatedRoute = activatedRoute;
        this.route = route;
        this.router = router;
        this.service = service;
        this.poComponentInjector = poComponentInjector;
        this.literals = Object.assign({}, poPageChangePasswordLiterals[poLocaleDefault], poPageChangePasswordLiterals[browserLanguage()]);
        this.componentRef = null;
        this.modalAction = {
            action: this.navigateTo.bind(this, this.urlHome),
            label: this.literals.enterSystemButton
        };
        this.parentRef = viewRef['_view']['component'];
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        if (this.urlNewPassword) {
            this.subscribeToTokenParameter();
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.newPasswordSubscription) {
            this.newPasswordSubscription.unsubscribe();
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.checkingForRouteMetadata(this.activatedRoute.snapshot.data);
    }
    /**
     * @param {?} url
     * @return {?}
     */
    navigateTo(url) {
        isExternalLink(url) ? window.open(url) : this.router.navigate([url || '/']);
    }
    /**
     * @param {?} recovery
     * @return {?}
     */
    onForgotPasswordClick(recovery) {
        if (isTypeof(recovery, 'function')) {
            recovery();
        }
        else {
            this.createModalPasswordRecoveryComponent(recovery);
        }
    }
    /**
     * @return {?}
     */
    onLoginSubmit() {
        /** @type {?} */
        const form = this.getLoginForm();
        if (this.urlNewPassword) {
            this.postUrlNewPassword(form);
        }
        else if (this.submit && this.submit.observers.length) {
            this.emitSubmit(form);
        }
    }
    /**
     * Abre uma modal de confirmação com texto, imagem e botão que redireciona para o link definido na propriedade `p-url-home`
     * @return {?}
     */
    openConfirmation() {
        this.modal.open();
    }
    /**
     * @return {?}
     */
    validatePassword() {
        /** @type {?} */
        const controls = this.passwordForm.form.controls;
        /** @type {?} */
        const controlConfirmPassword = controls['confirmPassword'];
        /** @type {?} */
        const controlNewPassword = controls['newPassword'];
        if (!this.newPassword) {
            this.setFormErrors({ 'required': true }, [controlNewPassword]);
        }
        else if (!this.confirmPassword) {
            this.setFormErrors({ 'required': true }, [controlConfirmPassword]);
        }
        else if (this.newPassword && this.confirmPassword && this.newPassword !== this.confirmPassword) {
            this.setFormErrors({ 'equalPassword': true }, [controlNewPassword, controlConfirmPassword]);
        }
        else {
            this.setFormErrors(null, [controlConfirmPassword, controlNewPassword]);
        }
        if (this.requirements.length && this.requirements.find((/**
         * @param {?} requirement
         * @return {?}
         */
        requirement => this.validateRequirement(requirement) === false))) {
            this.setFormErrors({ 'requirement': true }, [controlNewPassword]);
        }
    }
    /**
     * @param {?} requirement
     * @return {?}
     */
    validateRequirement(requirement) {
        return typeof requirement.status === 'function' ? requirement.status.call(this.parentRef, this.newPassword) : requirement.status;
    }
    /**
     * @private
     * @param {?} object
     * @param {?} property
     * @return {?}
     */
    checkingForMetadataProperty(object, property) {
        if (Object.prototype.hasOwnProperty.call(object, property)) {
            return object[property];
        }
    }
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    checkingForRouteMetadata(data) {
        if (Object.keys(data).length !== 0) {
            this.urlNewPassword = this.checkingForMetadataProperty(data, 'serviceApi') || this.urlNewPassword;
            this.recovery = this.checkingForMetadataProperty(data, 'recovery') || this.recovery;
            this.hideCurrentPassword = this.checkingForMetadataProperty(data, 'hideCurrentPassword') || this.hideCurrentPassword;
        }
    }
    /**
     * @private
     * @param {?} recovery
     * @return {?}
     */
    createModalPasswordRecoveryComponent(recovery) {
        if (this.componentRef) {
            this.poComponentInjector.destroyComponentInApplication(this.componentRef);
        }
        this.componentRef = this.poComponentInjector.createComponentInApplication(PoModalPasswordRecoveryComponent);
        this.componentRef.instance.recovery = recovery.url;
        this.componentRef.instance.contactEmail = recovery.contactMail;
        this.componentRef.instance.phoneMask = recovery.phoneMask;
        this.componentRef.instance.type = recovery.type || PoModalPasswordRecoveryType.Email;
        this.componentRef.changeDetectorRef.detectChanges();
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.componentRef.instance.open();
        }));
    }
    /**
     * @private
     * @param {?} form
     * @return {?}
     */
    emitSubmit(form) {
        this.submit.emit(form);
    }
    /**
     * @private
     * @return {?}
     */
    getLoginForm() {
        return {
            currentPassword: this.currentPassword,
            newPassword: this.newPassword
        };
    }
    /**
     * @private
     * @param {?} form
     * @return {?}
     */
    postUrlNewPassword(form) {
        form['token'] = this.token;
        this.service.post(this.urlNewPassword, form).subscribe((/**
         * @param {?} response
         * @return {?}
         */
        response => {
            if (response.status === 204) {
                this.openConfirmation();
            }
        }));
    }
    /**
     * @private
     * @param {?} error
     * @param {?=} controls
     * @return {?}
     */
    setFormErrors(error, controls) {
        controls.forEach((/**
         * @param {?} control
         * @return {?}
         */
        control => {
            control.setErrors(error);
        }));
    }
    /**
     * @private
     * @return {?}
     */
    subscribeToTokenParameter() {
        this.route.queryParams.subscribe((/**
         * @param {?} params
         * @return {?}
         */
        params => {
            /** @type {?} */
            const token = params['token'];
            if (token) {
                this.token = token;
            }
        }));
    }
}
PoPageChangePasswordComponent.decorators = [
    { type: Component, args: [{
                selector: 'po-page-change-password',
                template: "<div class=\"po-page-change-password-wrapper\" #pageChangePassword>\r\n  <div class=\"po-page-change-password-container\">\r\n    <po-page-background class=\"po-page-change-password\"\r\n      [p-logo]=\"logo\"\r\n      [p-secondary-logo]=\"secondaryLogo\">\r\n\r\n      <div class=\"po-page-blocked-user-header po-row\">\r\n        <div class=\"po-md-12\">{{literals.createNewPassword}}</div>\r\n        <div class=\"po-md-12 po-text-center po-font-text\">\r\n          {{literals.createNewPasswordPhrase}}\r\n        </div>\r\n      </div>\r\n\r\n      <form #passwordForm=\"ngForm\">\r\n\r\n        <div class=\"po-row po-mt-3 po-mt-sm-1\">\r\n          <div class=\"po-md-6\"\r\n            [ngClass]=\"{'po-offset-md-3 po-offset-lg-3 po-offset-xl-3': !showRequirements}\">\r\n            <div *ngIf=\"!hideCurrentPassword\">\r\n              <po-password\r\n                name=\"currentPassword\"\r\n                [(ngModel)]=\"currentPassword\"\r\n                p-required\r\n                [p-label]=\"literals.currentPassword\">\r\n              </po-password>\r\n            </div>\r\n            <div *ngIf=\"!hideCurrentPassword && recovery\" class=\"po-text-center po-mb-sm-1 po-mb-2\">\r\n              <a *ngIf=\"recoveryUrlType === 'internalLink'\"\r\n                class=\"po-font-text-bold po-page-change-password-forgot-password\"\r\n                [routerLink]=\"recovery\">\r\n                {{literals.forgotPassword}}\r\n              </a>\r\n              <a *ngIf=\"recoveryUrlType === 'externalLink'\"\r\n                class=\"po-font-text-bold po-page-change-password-forgot-password\"\r\n                [href]=\"recovery\">\r\n                {{literals.forgotPassword}}\r\n              </a>\r\n              <a *ngIf=\"!recoveryUrlType\"\r\n                class=\"po-font-text-bold po-page-change-password-forgot-password po-clickable\"\r\n                (click)=\"onForgotPasswordClick(recovery)\">\r\n                {{literals.forgotPassword}}\r\n              </a>\r\n            </div>\r\n            <div>\r\n              <po-password\r\n                name=\"newPassword\"\r\n                [(ngModel)]=\"newPassword\"\r\n                p-required\r\n                [p-label]=\"literals.newPassword\"\r\n                (p-change-model)=\"validatePassword()\">\r\n              </po-password>\r\n            </div>\r\n            <div>\r\n              <po-password\r\n                name=\"confirmPassword\"\r\n                [(ngModel)]=\"confirmPassword\"\r\n                p-required\r\n                [p-label]=\"literals.confirmPassword\"\r\n                (p-change-model)=\"validatePassword()\">\r\n              </po-password>\r\n            </div>\r\n          </div>\r\n          <div *ngIf=\"showRequirements\"\r\n            class=\"po-md-6 po-page-change-password-required-container\">\r\n            <po-container>\r\n              <ul class=\"po-page-change-password-required-list\">\r\n                <li class=\"po-page-change-password-required-item\">\r\n                  <p class=\"po-mb-1 po-font-text-bold po-page-change-password-required-title\">\r\n                    {{literals?.requirements}}\r\n                  </p>\r\n                </li>\r\n                <li *ngFor=\"let requirement of requirements\"\r\n                  class=\"po-page-change-password-required-item\">\r\n                  <span class=\"po-icon po-page-change-password-required-icon\"\r\n                    [ngClass]=\"validateRequirement(requirement) ? 'po-icon-ok po-page-change-password-required-ok' : 'po-icon-minus po-page-change-password-required-minus'\">\r\n                  </span>\r\n                  <p class=\"po-page-change-password-required-text po-font-text\">\r\n                    {{requirement.requirement}}\r\n                  </p>\r\n                </li>\r\n              </ul>\r\n            </po-container>\r\n          </div>\r\n        </div>\r\n      </form>\r\n\r\n      <po-divider class=\"po-sm-12\"></po-divider>\r\n\r\n      <div class=\"po-page-change-password-tips po-row\">\r\n        <div class=\"po-md-2 po-mr-3\">\r\n          <img\r\n            class=\"po-page-change-password-lock-image po-mb-3\"\r\n            alt=\"Blocked user image\"\r\n            src=\"./assets/images/big-lock.svg\"\r\n          />\r\n        </div>\r\n        <div class=\"po-md-9 po-page-change-password-tips-text\">\r\n          <div class=\"po-font-text-bold po-pb-1\">{{literals.safetyTips}}</div>\r\n          <div class=\"po-font-text-small\">\r\n            <div class=\"po-row po-pb-1\">{{literals.safetyTipsPhrase}}</div>\r\n            <div class=\"po-row po-pb-1\">\u2022 {{literals.safetyTipsFirst}}</div>\r\n            <div class=\"po-row po-pb-1\">\u2022 {{literals.safetyTipsSecond}}</div>\r\n            <div class=\"po-row po-pb-1\">\u2022 {{literals.safetyTipsThird}}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"po-page-change-password-buttons po-row\">\r\n\r\n        <po-divider class=\"po-sm-12 po-mobile-only\"></po-divider>\r\n\r\n        <po-button *ngIf=\"!hideCurrentPassword\"\r\n          class=\"po-sm-6 po-mb-sm-1\"\r\n          [p-label]=\"literals.backButton\"\r\n          (p-click)=\"navigateTo(urlBack)\">\r\n        </po-button>\r\n\r\n        <po-button\r\n          [ngClass]=\"hideCurrentPassword ? 'po-md-12':'po-sm-6'\"\r\n          p-type=\"primary\"\r\n          [p-disabled]=\"passwordForm.invalid\"\r\n          [p-label]=\"literals.saveButton\"\r\n          (p-click)=\"onLoginSubmit()\">\r\n        </po-button>\r\n\r\n      </div>\r\n\r\n    </po-page-background>\r\n\r\n  </div>\r\n</div>\r\n\r\n<po-modal\r\n  [p-primary-action]=\"modalAction\"\r\n  p-hide-close\r\n  p-size=\"auto\"\r\n  [p-title]=\"hideCurrentPassword ? literals.passwordSuccessfullyCreated : literals.passwordSuccessfullyUpdated\">\r\n\r\n  <div class=\"po-text-center\">\r\n    <img\r\n      alt=\"Blocked user image\"\r\n      class=\"po-page-change-password-lock-image po-mb-3\"\r\n      src=\"./assets/images/success.svg\"\r\n    />\r\n  </div>\r\n</po-modal>\r\n"
            }] }
];
/** @nocollapse */
PoPageChangePasswordComponent.ctorParameters = () => [
    { type: ActivatedRoute },
    { type: ActivatedRoute },
    { type: Router },
    { type: PoPageChangePasswordService },
    { type: PoComponentInjectorService },
    { type: ViewContainerRef }
];
PoPageChangePasswordComponent.propDecorators = {
    modal: [{ type: ViewChild, args: [PoModalComponent, { static: true },] }],
    pageChangePassword: [{ type: ViewChild, args: ['pageChangePassword', { read: ViewContainerRef, static: true },] }],
    passwordForm: [{ type: ViewChild, args: ['passwordForm', { read: NgForm, static: true },] }]
};
if (false) {
    /**
     * @type {?}
     * @private
     */
    PoPageChangePasswordComponent.prototype.newPasswordSubscription;
    /** @type {?} */
    PoPageChangePasswordComponent.prototype.literals;
    /**
     * @type {?}
     * @private
     */
    PoPageChangePasswordComponent.prototype.componentRef;
    /** @type {?} */
    PoPageChangePasswordComponent.prototype.modalAction;
    /** @type {?} */
    PoPageChangePasswordComponent.prototype.parentRef;
    /** @type {?} */
    PoPageChangePasswordComponent.prototype.modal;
    /** @type {?} */
    PoPageChangePasswordComponent.prototype.pageChangePassword;
    /** @type {?} */
    PoPageChangePasswordComponent.prototype.passwordForm;
    /**
     * @type {?}
     * @private
     */
    PoPageChangePasswordComponent.prototype.activatedRoute;
    /**
     * @type {?}
     * @private
     */
    PoPageChangePasswordComponent.prototype.route;
    /**
     * @type {?}
     * @private
     */
    PoPageChangePasswordComponent.prototype.router;
    /**
     * @type {?}
     * @private
     */
    PoPageChangePasswordComponent.prototype.service;
    /**
     * @type {?}
     * @private
     */
    PoPageChangePasswordComponent.prototype.poComponentInjector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHBvcnRpbmFyaS9wb3J0aW5hcmktdGVtcGxhdGVzLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvcG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQvcG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQWlCLFNBQVMsRUFBbUMsU0FBUyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZILE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN4QyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBSXpELE9BQU8sRUFBRSwwQkFBMEIsRUFBaUIsZ0JBQWdCLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUV0RyxPQUFPLEVBQUUsZUFBZSxFQUFFLGNBQWMsRUFBRSxRQUFRLEVBQUUsZUFBZSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFOUYsT0FBTyxFQUFFLGdDQUFnQyxFQUFFLE1BQU0sb0VBQW9FLENBQUM7QUFDdEgsT0FBTyxFQUFFLDJCQUEyQixFQUFFLE1BQU0sMEVBQTBFLENBQUM7QUFFdkgsT0FBTyxFQUFFLGlDQUFpQyxFQUFFLE1BQU0sMENBQTBDLENBQUM7QUFDN0YsT0FBTyxFQUFFLDRCQUE0QixFQUFFLE1BQU0sa0RBQWtELENBQUM7QUFHaEcsT0FBTyxFQUFFLDJCQUEyQixFQUFFLE1BQU0sbUNBQW1DLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFxQ2hGLE1BQU0sT0FBTyw2QkFBOEIsU0FBUSxpQ0FBaUM7Ozs7Ozs7OztJQTBCbEYsWUFDVSxjQUE4QixFQUM5QixLQUFxQixFQUNyQixNQUFjLEVBQ2QsT0FBb0MsRUFDcEMsbUJBQStDLEVBQ3ZELE9BQXlCO1FBQ3ZC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S0FBSyxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUM7WUFFN0IsSUFBSSxLQUFLLEVBQUU7Z0JBQ1QsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7YUFDcEI7UUFDSCxDQUFDLEVBQUMsQ0FBQztJQUNMLENBQUM7OztZQWxMRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLHlCQUF5QjtnQkFDbkMsby9MQUF1RDthQUN4RDs7OztZQWxEUSxjQUFjO1lBQWQsY0FBYztZQUFFLE1BQU07WUFldEIsMkJBQTJCO1lBWDNCLDBCQUEwQjtZQU40QyxnQkFBZ0I7OztvQkE0RTVGLFNBQVMsU0FBQyxnQkFBZ0IsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7aUNBQzVDLFNBQVMsU0FBQyxvQkFBb0IsRUFBRSxFQUFFLElBQUksRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFOzJCQUN4RSxTQUFTLFNBQUMsY0FBYyxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFOzs7Ozs7O0lBdEJ6RCxnRUFBOEM7O0lBRTlDLGlEQU9JOzs7OztJQUVKLHFEQUErQzs7SUFFL0Msb0RBR0U7O0lBRUYsa0RBQWU7O0lBRWYsOENBQXVFOztJQUN2RSwyREFBZ0g7O0lBQ2hILHFEQUFnRjs7Ozs7SUFHOUUsdURBQXNDOzs7OztJQUN0Qyw4Q0FBNkI7Ozs7O0lBQzdCLCtDQUFzQjs7Ozs7SUFDdEIsZ0RBQTRDOzs7OztJQUM1Qyw0REFBdUQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBZnRlclZpZXdJbml0LCBDb21wb25lbnQsIENvbXBvbmVudFJlZiwgT25EZXN0cm95LCBPbkluaXQsIFZpZXdDaGlsZCwgVmlld0NvbnRhaW5lclJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBOZ0Zvcm0gfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IEFjdGl2YXRlZFJvdXRlLCBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5cclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XHJcblxyXG5pbXBvcnQgeyBQb0NvbXBvbmVudEluamVjdG9yU2VydmljZSwgUG9Nb2RhbEFjdGlvbiwgUG9Nb2RhbENvbXBvbmVudCB9IGZyb20gJ0Bwb3J0aW5hcmkvcG9ydGluYXJpLXVpJztcclxuXHJcbmltcG9ydCB7IGJyb3dzZXJMYW5ndWFnZSwgaXNFeHRlcm5hbExpbmssIGlzVHlwZW9mLCBwb0xvY2FsZURlZmF1bHQgfSBmcm9tICcuLi8uLi91dGlscy91dGlsJztcclxuXHJcbmltcG9ydCB7IFBvTW9kYWxQYXNzd29yZFJlY292ZXJ5Q29tcG9uZW50IH0gZnJvbSAnLi4vcG8tbW9kYWwtcGFzc3dvcmQtcmVjb3ZlcnkvcG8tbW9kYWwtcGFzc3dvcmQtcmVjb3ZlcnkuY29tcG9uZW50JztcclxuaW1wb3J0IHsgUG9Nb2RhbFBhc3N3b3JkUmVjb3ZlcnlUeXBlIH0gZnJvbSAnLi4vcG8tbW9kYWwtcGFzc3dvcmQtcmVjb3ZlcnkvZW51bXMvcG8tbW9kYWwtcGFzc3dvcmQtcmVjb3ZlcnktdHlwZS5lbnVtJztcclxuaW1wb3J0IHsgUG9QYWdlQ2hhbmdlUGFzc3dvcmQgfSBmcm9tICcuL2ludGVyZmFjZXMvcG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQuaW50ZXJmYWNlJztcclxuaW1wb3J0IHsgUG9QYWdlQ2hhbmdlUGFzc3dvcmRCYXNlQ29tcG9uZW50IH0gZnJvbSAnLi9wby1wYWdlLWNoYW5nZS1wYXNzd29yZC1iYXNlLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IHBvUGFnZUNoYW5nZVBhc3N3b3JkTGl0ZXJhbHMgfSBmcm9tICcuL2xpdGVyYWxzL2kxOG4vcG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQtbGl0ZXJhbHMnO1xyXG5pbXBvcnQgeyBQb1BhZ2VDaGFuZ2VQYXNzd29yZFJlY292ZXJ5IH0gZnJvbSAnLi9pbnRlcmZhY2VzL3BvLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLXJlY292ZXJ5LmludGVyZmFjZSc7XHJcbmltcG9ydCB7IFBvUGFnZUNoYW5nZVBhc3N3b3JkUmVxdWlyZW1lbnQgfSBmcm9tICcuL2ludGVyZmFjZXMvcG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQtcmVxdWlyZW1lbnQuaW50ZXJmYWNlJztcclxuaW1wb3J0IHsgUG9QYWdlQ2hhbmdlUGFzc3dvcmRTZXJ2aWNlIH0gZnJvbSAnLi9wby1wYWdlLWNoYW5nZS1wYXNzd29yZC5zZXJ2aWNlJztcclxuXHJcbi8qKlxyXG4gKiBAZG9jc0V4dGVuZHMgUG9QYWdlQ2hhbmdlUGFzc3dvcmRCYXNlQ29tcG9uZW50XHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqXHJcbiAqIDxleGFtcGxlIG5hbWU9XCJwby1wYWdlLWNoYW5nZS1wYXNzd29yZC1iYXNpY1wiIHRpdGxlPVwiUG9ydGluYXJpIFBhZ2UgQ2hhbmdlIFBhc3N3b3JkIEJhc2ljXCI+XHJcbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXBvLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLWJhc2ljL3NhbXBsZS1wby1wYWdlLWNoYW5nZS1wYXNzd29yZC1iYXNpYy5jb21wb25lbnQuaHRtbFwiPiA8L2ZpbGU+XHJcbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXBvLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLWJhc2ljL3NhbXBsZS1wby1wYWdlLWNoYW5nZS1wYXNzd29yZC1iYXNpYy5jb21wb25lbnQudHNcIj4gPC9maWxlPlxyXG4gKiA8L2V4YW1wbGU+XHJcbiAqXHJcbiAqIDxleGFtcGxlIG5hbWU9XCJwby1wYWdlLWNoYW5nZS1wYXNzd29yZC1sYWJzXCIgdGl0bGU9XCJQb3J0aW5hcmkgUGFnZSBDaGFuZ2UgUGFzc3dvcmQgTGFic1wiPlxyXG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS1wby1wYWdlLWNoYW5nZS1wYXNzd29yZC1sYWJzL3NhbXBsZS1wby1wYWdlLWNoYW5nZS1wYXNzd29yZC1sYWJzLmNvbXBvbmVudC5odG1sXCI+IDwvZmlsZT5cclxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtcG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQtbGFicy9zYW1wbGUtcG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQtbGFicy5jb21wb25lbnQudHNcIj4gPC9maWxlPlxyXG4gKiA8L2V4YW1wbGU+XHJcbiAqXHJcbiAqIDxleGFtcGxlIG5hbWU9XCJwby1wYWdlLWNoYW5nZS1wYXNzd29yZC1tb2RpZnlcIiB0aXRsZT1cIlBvcnRpbmFyaSBQYWdlIENoYW5nZSBQYXNzd29yZCBNb2RpZnlcIj5cclxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtcG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQtbW9kaWZ5L3NhbXBsZS1wby1wYWdlLWNoYW5nZS1wYXNzd29yZC1tb2RpZnkuY29tcG9uZW50Lmh0bWxcIj4gPC9maWxlPlxyXG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS1wby1wYWdlLWNoYW5nZS1wYXNzd29yZC1tb2RpZnkvc2FtcGxlLXBvLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLW1vZGlmeS5jb21wb25lbnQudHNcIj4gPC9maWxlPlxyXG4gKiA8L2V4YW1wbGU+XHJcbiAqXHJcbiAqIDxleGFtcGxlIG5hbWU9XCJwby1wYWdlLWNoYW5nZS1wYXNzd29yZC1jcmVhdGVcIiB0aXRsZT1cIlBvcnRpbmFyaSBQYWdlIENoYW5nZSBQYXNzd29yZCBDcmVhdGVcIj5cclxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtcG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQtY3JlYXRlL3NhbXBsZS1wby1wYWdlLWNoYW5nZS1wYXNzd29yZC1jcmVhdGUuY29tcG9uZW50Lmh0bWxcIj4gPC9maWxlPlxyXG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS1wby1wYWdlLWNoYW5nZS1wYXNzd29yZC1jcmVhdGUvc2FtcGxlLXBvLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLWNyZWF0ZS5jb21wb25lbnQudHNcIj4gPC9maWxlPlxyXG4gKiA8L2V4YW1wbGU+XHJcbiAqXHJcbiAqIDxleGFtcGxlIG5hbWU9XCJwby1wYWdlLWNoYW5nZS1wYXNzd29yZC1yZXF1ZXN0XCIgdGl0bGU9XCJQb3J0aW5hcmkgUGFnZSBDaGFuZ2UgUGFzc3dvcmQgUmVxdWVzdFwiPlxyXG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS1wby1wYWdlLWNoYW5nZS1wYXNzd29yZC1yZXF1ZXN0L3NhbXBsZS1wby1wYWdlLWNoYW5nZS1wYXNzd29yZC1yZXF1ZXN0LmNvbXBvbmVudC5odG1sXCI+IDwvZmlsZT5cclxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtcG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQtcmVxdWVzdC9zYW1wbGUtcG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQtcmVxdWVzdC5jb21wb25lbnQudHNcIj4gPC9maWxlPlxyXG4gKiA8L2V4YW1wbGU+XHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3BvLXBhZ2UtY2hhbmdlLXBhc3N3b3JkJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vcG8tcGFnZS1jaGFuZ2UtcGFzc3dvcmQuY29tcG9uZW50Lmh0bWwnXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgUG9QYWdlQ2hhbmdlUGFzc3dvcmRDb21wb25lbnQgZXh0ZW5kcyBQb1BhZ2VDaGFuZ2VQYXNzd29yZEJhc2VDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3ksIE9uSW5pdCB7XHJcblxyXG4gIHByaXZhdGUgbmV3UGFzc3dvcmRTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcclxuXHJcbiAgcmVhZG9ubHkgbGl0ZXJhbHM6IHsgYmFja0J1dHRvbjogc3RyaW5nLCBjb25maXJtUGFzc3dvcmQ6IHN0cmluZywgY3JlYXRlTmV3UGFzc3dvcmQ6IHN0cmluZywgY3JlYXRlTmV3UGFzc3dvcmRQaHJhc2U6IHN0cmluZyxcclxuICAgIGN1cnJlbnRQYXNzd29yZDogc3RyaW5nLCBlbnRlclN5c3RlbUJ1dHRvbjogc3RyaW5nLCBmb3Jnb3RQYXNzd29yZDogc3RyaW5nLCBuZXdQYXNzd29yZDogc3RyaW5nLCBwYXNzd29yZFN1Y2Nlc3NmdWxseUNyZWF0ZWQ6IHN0cmluZyxcclxuICAgIHBhc3N3b3JkU3VjY2Vzc2Z1bGx5VXBkYXRlZDogc3RyaW5nLCByZXF1aXJlbWVudHM6IHN0cmluZywgc2FmZXR5VGlwczogc3RyaW5nLCBzYWZldHlUaXBzUGhyYXNlOiBzdHJpbmcsIHNhZmV0eVRpcHNGaXJzdDogc3RyaW5nLFxyXG4gICAgc2FmZXR5VGlwc1NlY29uZDogc3RyaW5nLCBzYWZldHlUaXBzVGhpcmQ6IHN0cmluZywgc2F2ZUJ1dHRvbjogc3RyaW5nIH0gPVxyXG4gICAge1xyXG4gICAgICAuLi5wb1BhZ2VDaGFuZ2VQYXNzd29yZExpdGVyYWxzW3BvTG9jYWxlRGVmYXVsdF0sXHJcbiAgICAgIC4uLnBvUGFnZUNoYW5nZVBhc3N3b3JkTGl0ZXJhbHNbYnJvd3Nlckxhbmd1YWdlKCldLFxyXG4gICAgfTtcclxuXHJcbiAgcHJpdmF0ZSBjb21wb25lbnRSZWY6IENvbXBvbmVudFJlZjxhbnk+ID0gbnVsbDtcclxuXHJcbiAgbW9kYWxBY3Rpb246IFBvTW9kYWxBY3Rpb24gPSB7XHJcbiAgICBhY3Rpb246IHRoaXMubmF2aWdhdGVUby5iaW5kKHRoaXMsIHRoaXMudXJsSG9tZSksXHJcbiAgICBsYWJlbDogdGhpcy5saXRlcmFscy5lbnRlclN5c3RlbUJ1dHRvblxyXG4gIH07XHJcblxyXG4gIHBhcmVudFJlZjogYW55O1xyXG5cclxuICBAVmlld0NoaWxkKFBvTW9kYWxDb21wb25lbnQsIHsgc3RhdGljOiB0cnVlIH0pIG1vZGFsOiBQb01vZGFsQ29tcG9uZW50O1xyXG4gIEBWaWV3Q2hpbGQoJ3BhZ2VDaGFuZ2VQYXNzd29yZCcsIHsgcmVhZDogVmlld0NvbnRhaW5lclJlZiwgc3RhdGljOiB0cnVlIH0pIHBhZ2VDaGFuZ2VQYXNzd29yZDogVmlld0NvbnRhaW5lclJlZjtcclxuICBAVmlld0NoaWxkKCdwYXNzd29yZEZvcm0nLCB7IHJlYWQ6IE5nRm9ybSwgc3RhdGljOiB0cnVlIH0pIHBhc3N3b3JkRm9ybTogTmdGb3JtO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgYWN0aXZhdGVkUm91dGU6IEFjdGl2YXRlZFJvdXRlLFxyXG4gICAgcHJpdmF0ZSByb3V0ZTogQWN0aXZhdGVkUm91dGUsXHJcbiAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyLFxyXG4gICAgcHJpdmF0ZSBzZXJ2aWNlOiBQb1BhZ2VDaGFuZ2VQYXNzd29yZFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHBvQ29tcG9uZW50SW5qZWN0b3I6IFBvQ29tcG9uZW50SW5qZWN0b3JTZXJ2aWNlLFxyXG4gICAgdmlld1JlZjogVmlld0NvbnRhaW5lclJlZikge1xyXG4gICAgICBzdXBlcigpO1xyXG4gICAgICB0aGlzLnBhcmVudFJlZiA9IHZpZXdSZWZbJ192aWV3J11bJ2NvbXBvbmVudCddO1xyXG4gIH1cclxuXHJcbiAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgaWYgKHRoaXMudXJsTmV3UGFzc3dvcmQpIHtcclxuICAgICAgdGhpcy5zdWJzY3JpYmVUb1Rva2VuUGFyYW1ldGVyKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBuZ09uRGVzdHJveSgpIHtcclxuICAgIGlmICh0aGlzLm5ld1Bhc3N3b3JkU3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgIHRoaXMubmV3UGFzc3dvcmRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5jaGVja2luZ0ZvclJvdXRlTWV0YWRhdGEodGhpcy5hY3RpdmF0ZWRSb3V0ZS5zbmFwc2hvdC5kYXRhKTtcclxuICB9XHJcblxyXG4gIG5hdmlnYXRlVG8odXJsOiBzdHJpbmcpIHtcclxuICAgIGlzRXh0ZXJuYWxMaW5rKHVybCkgPyAgd2luZG93Lm9wZW4odXJsKSA6IHRoaXMucm91dGVyLm5hdmlnYXRlKFt1cmwgfHwgJy8nXSk7XHJcbiAgfVxyXG5cclxuICBvbkZvcmdvdFBhc3N3b3JkQ2xpY2socmVjb3ZlcnkpOiB2b2lkIHtcclxuICAgIGlmIChpc1R5cGVvZihyZWNvdmVyeSwgJ2Z1bmN0aW9uJykpIHtcclxuICAgICAgcmVjb3ZlcnkoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuY3JlYXRlTW9kYWxQYXNzd29yZFJlY292ZXJ5Q29tcG9uZW50KHJlY292ZXJ5KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9uTG9naW5TdWJtaXQoKTogdm9pZCB7XHJcblxyXG4gICAgY29uc3QgZm9ybSA9IHRoaXMuZ2V0TG9naW5Gb3JtKCk7XHJcblxyXG4gICAgaWYgKHRoaXMudXJsTmV3UGFzc3dvcmQpIHtcclxuICAgICAgdGhpcy5wb3N0VXJsTmV3UGFzc3dvcmQoZm9ybSk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3VibWl0ICYmIHRoaXMuc3VibWl0Lm9ic2VydmVycy5sZW5ndGgpIHtcclxuICAgICAgdGhpcy5lbWl0U3VibWl0KGZvcm0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWJyZSB1bWEgbW9kYWwgZGUgY29uZmlybWHDp8OjbyBjb20gdGV4dG8sIGltYWdlbSBlIGJvdMOjbyBxdWUgcmVkaXJlY2lvbmEgcGFyYSBvIGxpbmsgZGVmaW5pZG8gbmEgcHJvcHJpZWRhZGUgYHAtdXJsLWhvbWVgXHUwMDFjXHJcbiAgICovXHJcbiAgb3BlbkNvbmZpcm1hdGlvbigpIHtcclxuICAgIHRoaXMubW9kYWwub3BlbigpO1xyXG4gIH1cclxuXHJcbiAgdmFsaWRhdGVQYXNzd29yZCgpIHtcclxuICAgIGNvbnN0IGNvbnRyb2xzID0gIHRoaXMucGFzc3dvcmRGb3JtLmZvcm0uY29udHJvbHM7XHJcbiAgICBjb25zdCBjb250cm9sQ29uZmlybVBhc3N3b3JkID0gY29udHJvbHNbJ2NvbmZpcm1QYXNzd29yZCddO1xyXG4gICAgY29uc3QgY29udHJvbE5ld1Bhc3N3b3JkID0gY29udHJvbHNbJ25ld1Bhc3N3b3JkJ107XHJcblxyXG4gICAgaWYgKCF0aGlzLm5ld1Bhc3N3b3JkKSB7XHJcbiAgICAgIHRoaXMuc2V0Rm9ybUVycm9ycyh7J3JlcXVpcmVkJzogdHJ1ZX0sIFtjb250cm9sTmV3UGFzc3dvcmRdKTtcclxuICAgIH0gZWxzZSBpZiAoIXRoaXMuY29uZmlybVBhc3N3b3JkKSB7XHJcbiAgICAgIHRoaXMuc2V0Rm9ybUVycm9ycyh7J3JlcXVpcmVkJzogdHJ1ZX0sIFtjb250cm9sQ29uZmlybVBhc3N3b3JkXSk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMubmV3UGFzc3dvcmQgJiYgdGhpcy5jb25maXJtUGFzc3dvcmQgJiYgdGhpcy5uZXdQYXNzd29yZCAhPT0gdGhpcy5jb25maXJtUGFzc3dvcmQpIHtcclxuICAgICAgdGhpcy5zZXRGb3JtRXJyb3JzKHsnZXF1YWxQYXNzd29yZCc6IHRydWV9LCBbY29udHJvbE5ld1Bhc3N3b3JkLCBjb250cm9sQ29uZmlybVBhc3N3b3JkXSk7XHJcbiAgICB9ICBlbHNlIHtcclxuICAgICAgdGhpcy5zZXRGb3JtRXJyb3JzKG51bGwsIFtjb250cm9sQ29uZmlybVBhc3N3b3JkLCBjb250cm9sTmV3UGFzc3dvcmRdKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5yZXF1aXJlbWVudHMubGVuZ3RoICYmIHRoaXMucmVxdWlyZW1lbnRzLmZpbmQocmVxdWlyZW1lbnQgPT4gIHRoaXMudmFsaWRhdGVSZXF1aXJlbWVudChyZXF1aXJlbWVudCkgPT09IGZhbHNlKSkge1xyXG4gICAgICB0aGlzLnNldEZvcm1FcnJvcnMoeydyZXF1aXJlbWVudCc6IHRydWV9LCBbY29udHJvbE5ld1Bhc3N3b3JkXSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICB2YWxpZGF0ZVJlcXVpcmVtZW50KHJlcXVpcmVtZW50OiBQb1BhZ2VDaGFuZ2VQYXNzd29yZFJlcXVpcmVtZW50KSB7XHJcbiAgICByZXR1cm4gdHlwZW9mIHJlcXVpcmVtZW50LnN0YXR1cyA9PT0gJ2Z1bmN0aW9uJyA/IHJlcXVpcmVtZW50LnN0YXR1cy5jYWxsKHRoaXMucGFyZW50UmVmLCB0aGlzLm5ld1Bhc3N3b3JkKSA6IHJlcXVpcmVtZW50LnN0YXR1cztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2hlY2tpbmdGb3JNZXRhZGF0YVByb3BlcnR5KG9iamVjdCwgcHJvcGVydHkpIHtcclxuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSkpIHtcclxuICAgICAgcmV0dXJuIG9iamVjdFtwcm9wZXJ0eV07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNoZWNraW5nRm9yUm91dGVNZXRhZGF0YShkYXRhKSB7XHJcbiAgICBpZiAoT2JqZWN0LmtleXMoZGF0YSkubGVuZ3RoICE9PSAwKSB7XHJcbiAgICAgIHRoaXMudXJsTmV3UGFzc3dvcmQgPSB0aGlzLmNoZWNraW5nRm9yTWV0YWRhdGFQcm9wZXJ0eShkYXRhLCAnc2VydmljZUFwaScpIHx8IHRoaXMudXJsTmV3UGFzc3dvcmQ7XHJcbiAgICAgIHRoaXMucmVjb3ZlcnkgPSB0aGlzLmNoZWNraW5nRm9yTWV0YWRhdGFQcm9wZXJ0eShkYXRhLCAncmVjb3ZlcnknKSB8fCB0aGlzLnJlY292ZXJ5O1xyXG4gICAgICB0aGlzLmhpZGVDdXJyZW50UGFzc3dvcmQgPSB0aGlzLmNoZWNraW5nRm9yTWV0YWRhdGFQcm9wZXJ0eShkYXRhLCAnaGlkZUN1cnJlbnRQYXNzd29yZCcpIHx8IHRoaXMuaGlkZUN1cnJlbnRQYXNzd29yZDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlTW9kYWxQYXNzd29yZFJlY292ZXJ5Q29tcG9uZW50KHJlY292ZXJ5OiBQb1BhZ2VDaGFuZ2VQYXNzd29yZFJlY292ZXJ5KSB7XHJcbiAgICBpZiAodGhpcy5jb21wb25lbnRSZWYpIHtcclxuICAgICAgdGhpcy5wb0NvbXBvbmVudEluamVjdG9yLmRlc3Ryb3lDb21wb25lbnRJbkFwcGxpY2F0aW9uKHRoaXMuY29tcG9uZW50UmVmKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmNvbXBvbmVudFJlZiA9IHRoaXMucG9Db21wb25lbnRJbmplY3Rvci5jcmVhdGVDb21wb25lbnRJbkFwcGxpY2F0aW9uKFBvTW9kYWxQYXNzd29yZFJlY292ZXJ5Q29tcG9uZW50KTtcclxuICAgIHRoaXMuY29tcG9uZW50UmVmLmluc3RhbmNlLnJlY292ZXJ5ID0gcmVjb3ZlcnkudXJsO1xyXG4gICAgdGhpcy5jb21wb25lbnRSZWYuaW5zdGFuY2UuY29udGFjdEVtYWlsID0gcmVjb3ZlcnkuY29udGFjdE1haWw7XHJcbiAgICB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS5waG9uZU1hc2sgPSByZWNvdmVyeS5waG9uZU1hc2s7XHJcbiAgICB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS50eXBlID0gcmVjb3ZlcnkudHlwZSB8fCBQb01vZGFsUGFzc3dvcmRSZWNvdmVyeVR5cGUuRW1haWw7XHJcbiAgICB0aGlzLmNvbXBvbmVudFJlZi5jaGFuZ2VEZXRlY3RvclJlZi5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5jb21wb25lbnRSZWYuaW5zdGFuY2Uub3BlbigpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGVtaXRTdWJtaXQoZm9ybTogUG9QYWdlQ2hhbmdlUGFzc3dvcmQpIHtcclxuICAgIHRoaXMuc3VibWl0LmVtaXQoZm9ybSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldExvZ2luRm9ybSgpOiBQb1BhZ2VDaGFuZ2VQYXNzd29yZCB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBjdXJyZW50UGFzc3dvcmQ6IHRoaXMuY3VycmVudFBhc3N3b3JkLFxyXG4gICAgICBuZXdQYXNzd29yZDogdGhpcy5uZXdQYXNzd29yZFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcG9zdFVybE5ld1Bhc3N3b3JkKGZvcm06IFBvUGFnZUNoYW5nZVBhc3N3b3JkKSB7XHJcblxyXG4gICAgZm9ybVsndG9rZW4nXSA9IHRoaXMudG9rZW47XHJcblxyXG4gICAgdGhpcy5zZXJ2aWNlLnBvc3QodGhpcy51cmxOZXdQYXNzd29yZCwgZm9ybSkuc3Vic2NyaWJlKHJlc3BvbnNlID0+IHtcclxuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjA0KSB7XHJcbiAgICAgICAgdGhpcy5vcGVuQ29uZmlybWF0aW9uKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzZXRGb3JtRXJyb3JzKGVycm9yOiBhbnksIGNvbnRyb2xzPzogQXJyYXk8YW55Pikge1xyXG4gICAgY29udHJvbHMuZm9yRWFjaChjb250cm9sID0+IHtcclxuICAgICAgY29udHJvbC5zZXRFcnJvcnMoZXJyb3IpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHN1YnNjcmliZVRvVG9rZW5QYXJhbWV0ZXIoKSB7XHJcbiAgICB0aGlzLnJvdXRlLnF1ZXJ5UGFyYW1zLnN1YnNjcmliZShwYXJhbXMgPT4ge1xyXG4gICAgICBjb25zdCB0b2tlbiA9IHBhcmFtc1sndG9rZW4nXTtcclxuXHJcbiAgICAgIGlmICh0b2tlbikge1xyXG4gICAgICAgIHRoaXMudG9rZW4gPSB0b2tlbjtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxufVxyXG4iXX0=